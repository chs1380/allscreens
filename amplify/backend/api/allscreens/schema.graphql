type ClassRoom 
@model 
@key(fields: ["name"])
@auth(rules: [
    {allow: owner}
]) {
    teacherEmail: AWSEmail!
    name: String!,
    kendraIndexId: String!
    studentEmails:[AWSEmail]!
}

type ScreenSharingTicket 
@model(subscriptions: null) 
@key(fields: ["email"])
@auth(rules: [
    {allow: owner },
    {allow: groups, groups: ["students"], groupClaim: "user_groups", operations: [read]}
]) {
    email: AWSEmail!
    teacherEmail: AWSEmail!
    kendraIndexId: String!
    activeUntil: AWSDateTime!
}

type Message
@model(subscriptions: null) 
@key(fields: ["email"])
@auth(rules: [
    {allow: owner },
    {allow: groups, groups: ["teachers"], groupClaim: "user_groups", operations: [read]}
    {allow: groups, groups: ["students"], groupClaim: "user_groups", operations: [read]}
]) {
    email: AWSEmail!
    content: String!
    command: String!
}

type Subscription {
  onCreateScreenSharingTicket(email: AWSEmail!): ScreenSharingTicket
    @aws_subscribe(mutations: ["createScreenSharingTicket"])
    
  onCreateMessage(email: AWSEmail!): Message
    @aws_subscribe(mutations: ["createMessage"])    
}